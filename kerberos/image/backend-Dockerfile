FROM 10.19.248.12:30100/tools/dep-centos7-spark-2.1.1-hadoop-2.7:0.1-lbsheng

ARG ARG_VERSION=1.0.4-SNAPSHOT

ADD escheduler-${ARG_VERSION}.tar.gz /opt/escheduler-${ARG_VERSION}

RUN yum install -y sudo && \
        yum clean all && \
        rm -rf /var/cache/yum/*

RUN cd /opt && \
        ln -s escheduler-${ARG_VERSION} escheduler

WORKDIR /opt/escheduler

# Kerberos
RUN yum install -y krb5-devel krb5-workstation
RUN mkdir /var/log/krb5

# jce
RUN yum install -y zip unzip
RUN yum install -y wget jsvc
RUN wget --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie;" http://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip
RUN unzip jce_policy-8.zip -d /usr/local/
RUN mv /usr/local/UnlimitedJCEPolicyJDK8/*.jar $JAVA_HOME/jre/lib/security/
RUN rm jce_policy-8.zip

